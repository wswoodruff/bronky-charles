(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
'use strict';
/**
 *
 * fart.js
 * A javascript library for adding fart sounds to your web experience
 *
 *
 * @author 	Tel Smith
 * @tweet 	@74656c
 * @web 	http://jsfart.com/
 * @github 	https://github.com/74656c/fart.js/
 *
 * version 2.0.0
 *
 * Remove need for jQuery for actual plugin
 *
 *
 */

/**
 * Here are the main fart sounds.
 * fart name : fart file (minus extension)
 */

var farts = {
  toot: 'fart1',
  ripper: 'fart2',
  plop: 'fart3',
  squit: 'fart4',
  raspberry: 'fart5',
  squat: 'fart6',
  tuppence: 'fart7',
  liftoff: 'fart8',
  trumpet: 'fart9',
  fizzler: 'fart10',
  windy: 'fart11',
  eine: 'fart12',
  fartception: 'fart13',
  fartpoint1: 'fart14'
};
/**
* This is the Fart constructor.
*
* @class Fart
* @constructor
*
* @param {Object} options Default Sound, Loop and Volume
*/

function Fart(options) {
  this.sound = this.default_sound;
  this.fart_player = null;
  this.old_player = false;
  this.options = this.fartxtend({
    default_sound: farts.raspberry,
    loop: false,
    volume: 50 // 0 - 100

  }, options);
  this.init();
}

Fart.preloaded = false;
/**
 *
 * Mimic jQuery Extend. 			✓
 * Change name for Fart-based LOL. 	✓
 *
 */

Fart.prototype.fartxtend = function (options, defaults) {
  for (var key in defaults) {
    if (defaults.hasOwnProperty(key)) {
      options[key] = defaults[key];
    }
  }

  return options;
};
/**
* Init the player. Figure out if the old player should be loaded by checking if the audio element has the canPlayType() method
*
* @method init
*/


Fart.prototype.init = function () {
  this.fart_player = document.createElement("audio");

  if (typeof this.fart_player.canPlayType == 'undefined') {
    this.load_old_player();
  }

  this.preload();
};
/**
* If the browser is too old to load an AUDIO element, its probably ie7/8
*
* @method load_old_player
*/


Fart.prototype.load_old_player = function () {
  document.body.innerHTML += '<div style="display:none;"><object id="contentPlayer" classid="CLSID:6BF52A52-394A-11d3-B153-00C04F79FAA6" width="100" height="100"><param name="volume" value="100%" /><param name="windowlessVideo" value="true"><param name="AnimationatStart" value="0" /><param name="autostart" value="1" /></object></div>';
  this.fart_player = document.getElementById('contentPlayer');
  this.fart_old_player = true;
};
/**
* Play the sound via the browser.
* If a valid $sound is passed, it will play, otherwise it will default to the defaut sound
*
* @method play
* @param {String} foo The name of the sound to play
* @param {String} foo A callback for once the sound has ended
*/


Fart.prototype.play = function (sound, callback) {
  var fart = sound ? farts[sound] ? farts[sound] : sound : this.options.default_sound;
  callback = callback || null;

  if (!this.fart_old_player) {
    var ext = this.fart_player.canPlayType('audio/mp3') ? '.mp3' : '.wav';
    this.fart_player.setAttribute('src', "/public/farts/" + fart + ext);
    this.fart_player.loop = this.options.loop;
    this.fart_player.volume = this.options.volume / 100;
    this.fart_player.play();
    $(this.fart_player).on("ended", function () {
      if (callback) {
        callback();
        $(this.fart_player).off("ended");
      }
    });
  } else {
    this.fart_player.URL = "/farts/" + fart + '.mp3';
  }
};
/**
* Stop the sound from playing
*
* @method stop
*/


Fart.prototype.stop = function () {
  this.fart_player.pause();
};
/**
* Remove the element from the DOM
*
* @method remove
*/


Fart.prototype.remove = function () {
  this.fart_player.remove();
};
/**
* Play a random fart from the list
*
* @method random
*/


Fart.prototype.random = function () {
  var keys = Object.keys(farts);
  var fart = keys[keys.length * Math.random() << 0];
  this.play(fart);
};
/**
* Try and preload the sounds. This was useful when the sound files where on a remote server
*
* @method preload
*/


Fart.prototype.preload = function () {
  var fart_player = this.fart_player;

  if (!this.fart_old_player && !Fart.preloaded) {
    Object.values(farts).forEach(function (val) {
      var ext = fart_player.canPlayType('audio/mp3') ? '.mp3' : '.wav';
      fart_player.setAttribute('src', "/farts/" + val + ext); // console.log('preload:',val);
    });
    Fart.preloaded = true;
  }
};

module.exports = {
  Fart: Fart,
  farts: farts
};

},{}],2:[function(require,module,exports){
'use strict';

console.log('Hello bronky!'); // Special thanks

console.log('Special thanks to fart.js for the farts! — http://jsfart.com');
console.log('Special thanks to CSShake for the shakes! — https://elrumordelaluz.github.io/csshake'); // 4 the devs

var PLAY_FART_SOUNDS = true;
var RUN_SHAKES = true; // OPENING SCREEN SHOULD BE BIG WHITE TEXT
// GIMME A HIGH FIVE!!
// WITH BOTH HANDS HIGH FIVE HANDS
// THEN HE TURNS INTO DANCING BRONKY WITH YOUR IP ADDRESS

var utils = {};

utils.randomFromArray = function (arr) {
  return arr[Math.floor(Math.random() * arr.length)];
};

utils.randomFromArrayExcept = function (arr) {
  for (var _len = arguments.length, except = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
    except[_key - 1] = arguments[_key];
  }

  var filtered = arr.filter(function (x) {
    return x !== except;
  });
  return filtered[Math.floor(Math.random() * filtered.length)];
}; // Init


var chosenFarts = [// 'toot', // There's no toot without tuppence
// 'tuppence', // There's no tuppence without toot
'ripper', 'raspberry', 'trumpet', 'windy' // Ahhh, Chicago
];
var chosenShakes = ['shake-hard', 'shake-crazy']; // Init the farts from fart.js

var _require = require('./fart'),
    Fart = _require.Fart,
    farts = _require.farts;

var fart = new Fart({
  volume: 100
});
window.Fart = Fart;
window.bronkyFart = fart;
window.farts = farts;

var playFart = function playFart(chosenFart) {
  if (!PLAY_FART_SOUNDS) {
    return;
  }

  fart.play(chosenFart);
};

var bronky = document.getElementById('bronkyContent'); // Init Bronky's shakes from CSShakes

var initShakeClasses = ['shake-constant', 'shake-slow' // 'shake-constant--hover'
// 'shake-freeze'
// 'shake-opacity'
];

if (RUN_SHAKES) {
  var _bronky$classList;

  (_bronky$classList = bronky.classList).add.apply(_bronky$classList, initShakeClasses);
}

var isFarting = false;

var shakeBronky = function shakeBronky(shake, duration) {
  var _bronky$classList2;

  if (!RUN_SHAKES) {
    return;
  }

  isFarting = true;

  (_bronky$classList2 = bronky.classList).remove.apply(_bronky$classList2, chosenShakes);

  bronky.classList.add(shake);
  setTimeout(function () {
    bronky.classList.remove(shake);
    isFarting = false;
  }, duration || Math.random() * 3000 + 2000);
};

var mobileRegex = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i;
var isMobile = false;

if (mobileRegex.test(navigator.userAgent)) {
  isMobile = true;
}

var lastFart = null;
var lastShake = null;
var forceFart = null;

var bronkyFart = function bronkyFart() {
  var shakeFartSettings = {
    toot: {
      shakeNameChoices: ['shake-little', 'shake-rotate'],
      duration: 1000
    },
    tuppence: {
      shakeNameChoices: ['shake-little', 'shake-rotate'],
      duration: 1000
    },
    ripper: {
      shakeNameChoices: ['shake-hard', 'shake-vertical'],
      duration: 1500
    },
    raspberry: {
      shakeNameChoices: ['shake-crazy', 'shake-rotate'],
      duration: 2000
    },
    trumpet: {
      shakeNameChoices: ['shake-hard', 'shake-crazy', 'shake-rotate'],
      duration: 1400
    },
    windy: {
      shakeNameChoices: ['shake-hard', 'shake-rotate'],
      duration: 5800
    }
  };
  var randomFart = forceFart ? forceFart : utils.randomFromArrayExcept(chosenFarts, lastFart) || 'raspberry';

  if (forceFart) {
    forceFart = null;
  }

  lastFart = randomFart;
  var _shakeFartSettings$ra = shakeFartSettings[randomFart],
      shakeNameChoices = _shakeFartSettings$ra.shakeNameChoices,
      duration = _shakeFartSettings$ra.duration;
  playFart(randomFart);
  var AUDIO_LOAD_TIMEOUT = isMobile ? 200 : 400;
  setTimeout(function () {
    var randomShake = utils.randomFromArrayExcept([].concat(shakeNameChoices), lastShake) || 'shake-rotate';
    lastShake = randomShake;
    shakeBronky(randomShake, duration);
  }, AUDIO_LOAD_TIMEOUT);
};

var okStopTheFarts = document.getElementById('okStopTheFartsBtn');

if (isMobile) {
  console.log('isMobile', isMobile);
  okStopTheFarts.style.padding = '200px';
} // Position the ip address div


var isLocal = window.location.host.startsWith('localhost:');
var isBronky = window.location.host === 'bronkycharles.com';
var isBronkonious = window.location.host === 'bronkoniouscharleston.com';
var urIp = document.getElementById('urip');
urIp.style.top = '150px';

if (isLocal || isBronky) {
  urIp.style.left = '150px';
  urIp.style.transform = 'rotate(-45deg)';
} else if (isBronkonious) {
  urIp.style.right = '150px';
  urIp.style.transform = 'rotate(45deg)';
} // Init the webpage playing a fart in case that works.
// Normally the user has to interact with the document before
// a sound can be played.
// At least we'll shake bronky loL


bronkyFart();
setInterval(function () {
  if (!isFarting) {
    bronkyFart();
  }
}, 10000);

document.onclick = function () {
  forceFart = 'trumpet';
  bronkyFart();
}; // Live chat
//

},{"./fart":1}]},{},[2])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJsaWIvcHVibGljL2pzL2ZhcnQuanMiLCJsaWIvcHVibGljL2pzL21haW4uanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsSUFBTSxLQUFLLEdBQUc7QUFDYixFQUFBLElBQUksRUFBRSxPQURPO0FBRWIsRUFBQSxNQUFNLEVBQUUsT0FGSztBQUdiLEVBQUEsSUFBSSxFQUFFLE9BSE87QUFJYixFQUFBLEtBQUssRUFBRSxPQUpNO0FBS2IsRUFBQSxTQUFTLEVBQUUsT0FMRTtBQU1iLEVBQUEsS0FBSyxFQUFFLE9BTk07QUFPYixFQUFBLFFBQVEsRUFBRSxPQVBHO0FBUWIsRUFBQSxPQUFPLEVBQUUsT0FSSTtBQVNiLEVBQUEsT0FBTyxFQUFFLE9BVEk7QUFVYixFQUFBLE9BQU8sRUFBRSxRQVZJO0FBV2IsRUFBQSxLQUFLLEVBQUUsUUFYTTtBQVliLEVBQUEsSUFBSSxFQUFFLFFBWk87QUFhYixFQUFBLFdBQVcsRUFBRSxRQWJBO0FBY2IsRUFBQSxVQUFVLEVBQUU7QUFkQyxDQUFkO0FBaUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBQ0EsU0FBUyxJQUFULENBQWMsT0FBZCxFQUF1QjtBQUN0QixPQUFLLEtBQUwsR0FBYSxLQUFLLGFBQWxCO0FBQ0EsT0FBSyxXQUFMLEdBQW1CLElBQW5CO0FBQ0EsT0FBSyxVQUFMLEdBQWtCLEtBQWxCO0FBQ0EsT0FBSyxPQUFMLEdBQWUsS0FBSyxTQUFMLENBQWU7QUFDN0IsSUFBQSxhQUFhLEVBQUcsS0FBSyxDQUFDLFNBRE87QUFFN0IsSUFBQSxJQUFJLEVBQUcsS0FGc0I7QUFHN0IsSUFBQSxNQUFN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QkFBL0M7QUFFQSxJQUFNLElBQUksR0FBRyxRQUFRLENBQUMsY0FBVCxDQUF3QixNQUF4QixDQUFiO0FBRUEsSUFBSSxDQUFDLEtBQUwsQ0FBVyxHQUFYLEdBQWlCLE9BQWpCOztBQUVBLElBQUksT0FBTyxJQUFJLFFBQWYsRUFBeUI7QUFDckIsRUFBQSxJQUFJLENBQUMsS0FBTCxDQUFXLElBQVgsR0FBa0IsT0FBbEI7QUFDQSxFQUFBLElBQUksQ0FBQyxLQUFMLENBQVcsU0FBWCxHQUF1QixnQkFBdkI7QUFDSCxDQUhELE1BSUssSUFBSSxhQUFKLEVBQW1CO0FBQ3BCLEVBQUEsSUFBSSxDQUFDLEtBQUwsQ0FBVyxLQUFYLEdBQW1CLE9BQW5CO0FBQ0EsRUFBQSxJQUFJLENBQUMsS0FBTCxDQUFXLFNBQVgsR0FBdUIsZUFBdkI7QUFDSCxDLENBRUQ7QUFDQTtBQUNBO0FBQ0E7OztBQUNBLFVBQVU7QUFFVixXQUFXLENBQUMsWUFBTTtBQUVkLE1BQUksQ0FBQyxTQUFMLEVBQWdCO0FBQ1osSUFBQSxVQUFVO0FBQ2I7QUFDSixDQUxVLEVBS1IsS0FMUSxDQUFYOztBQU9BLFFBQVEsQ0FBQyxPQUFULEdBQW1CLFlBQU07QUFFckIsRUFBQSxTQUFTLEdBQUcsU0FBWjtBQUNBLEVBQUEsVUFBVTtBQUNiLENBSkQsQyxDQU1BO0FBRUEiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbigpe2Z1bmN0aW9uIHIoZSxuLHQpe2Z1bmN0aW9uIG8oaSxmKXtpZighbltpXSl7aWYoIWVbaV0pe3ZhciBjPVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmU7aWYoIWYmJmMpcmV0dXJuIGMoaSwhMCk7aWYodSlyZXR1cm4gdShpLCEwKTt2YXIgYT1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK2krXCInXCIpO3Rocm93IGEuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixhfXZhciBwPW5baV09e2V4cG9ydHM6e319O2VbaV1bMF0uY2FsbChwLmV4cG9ydHMsZnVuY3Rpb24ocil7dmFyIG49ZVtpXVsxXVtyXTtyZXR1cm4gbyhufHxyKX0scCxwLmV4cG9ydHMscixlLG4sdCl9cmV0dXJuIG5baV0uZXhwb3J0c31mb3IodmFyIHU9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZSxpPTA7aTx0Lmxlbmd0aDtpKyspbyh0W2ldKTtyZXR1cm4gb31yZXR1cm4gcn0pKCkiLCIndXNlIHN0cmljdCc7XG5cbi8qKlxuICpcbiAqIGZhcnQuanNcbiAqIEEgamF2YXNjcmlwdCBsaWJyYXJ5IGZvciBhZGRpbmcgZmFydCBzb3VuZHMgdG8geW91ciB3ZWIgZXhwZXJpZW5jZVxuICpcbiAqXG4gKiBAYXV0aG9yIFx0VGVsIFNtaXRoXG4gKiBAdHdlZXQgXHRANzQ2NTZjXG4gKiBAd2ViIFx0aHR0cDovL2pzZmFydC5jb20vXG4gKiBAZ2l0aHViIFx0aHR0cHM6Ly9naXRodWIuY29tLzc0NjU2Yy9mYXJ0LmpzL1xuICpcbiAqIHZlcnNpb24gMi4wLjBcbiAqXG4gKiBSZW1vdmUgbmVlZCBmb3IgalF1ZXJ5IGZvciBhY3R1YWwgcGx1Z2luXG4gKlxuICpcbiAqL1xuXG5cbi8qKlxuICogSGVyZSBhcmUgdGhlIG1haW4gZmFydCBzb3VuZHMuXG4gKiBmYXJ0IG5hbWUgOiBmYXJ0IGZpbGUgKG1pbnVzIGV4dGVuc2lvbilcbiAqL1xuXG5jb25zdCBmYXJ0cyA9IHtcblx0dG9vdDogJ2ZhcnQxJyxcblx0cmlwcGVyOiAnZmFydDInLFxuXHRwbG9wOiAnZmFydDMnLFxuXHRzcXVpdDogJ2ZhcnQ0Jyxcblx0cmFzcGJlcnJ5OiAnZmFydDUnLFxuXHRzcXVhdDogJ2ZhcnQ2Jyxcblx0dHVwcGVuY2U6ICdmYXJ0NycsXG5cdGxpZnRvZmY6ICdmYXJ0OCcsXG5cdHRydW1wZXQ6ICdmYXJ0OScsXG5cdGZpenpsZXI6ICdmYXJ0MTAnLFxuXHR3aW5keTogJ2ZhcnQxMScsXG5cdGVpbmU6ICdmYXJ0MTInLFxuXHRmYXJ0Y2VwdGlvbjogJ2ZhcnQxMycsXG5cdGZhcnRwb2ludDE6ICdmYXJ0MTQnXG59O1xuXG4vKipcbiogVGhpcyBpcyB0aGUgRmFydCBjb25zdHJ1Y3Rvci5cbipcbiogQGNsYXNzIEZhcnRcbiogQGNvbnN0cnVjdG9yXG4qXG4qIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zIERlZmF1bHQgU291bmQsIExvb3AgYW5kIFZvbHVtZVxuKi9cbmZ1bmN0aW9uIEZhcnQob3B0aW9ucykge1xuXHR0aGlzLnNvdW5kID0gdGhpcy5kZWZhdWx0X3NvdW5kO1xuXHR0aGlzLmZhcnRfcGxheWVyID0gbnVsbDtcblx0dGhpcy5vbGRfcGxheWVyID0gZmFsc2U7XG5cdHRoaXMub3B0aW9ucyA9IHRoaXMuZmFydHh0ZW5kKHtcblx0XHRkZWZhdWx0X3NvdW5kIDogZmFydHMucmFzcGJlcnJ5LFxuXHRcdGxvb3AgOiBmYWxzZSxcblx0XHR2b2x1bWUgOiA1MFx0Ly8gMCAtIDEwMFxuXHR9LCBvcHRpb25zKTtcblx0dGhpcy5pbml0KCk7XG59XG5GYXJ0LnByZWxvYWRlZCA9IGZhbHNlO1xuXG4vKipcbiAqXG4gKiBNaW1pYyBqUXVlcnkgRXh0ZW5kLiBcdFx0XHTinJNcbiAqIENoYW5nZSBuYW1lIGZvciBGYXJ0LWJhc2VkIExPTC4gXHTinJNcbiAqXG4gKi9cbkZhcnQucHJvdG90eXBlLmZhcnR4dGVuZCA9IGZ1bmN0aW9uKG9wdGlvbnMsIGRlZmF1bHRzKSB7XG4gICAgZm9yKHZhciBrZXkgaW4gZGVmYXVsdHMpe1xuICAgICAgICBpZihkZWZhdWx0cy5oYXNPd25Qcm9wZXJ0eShrZXkpKXtcbiAgICAgICAgXHRvcHRpb25zW2tleV0gPSBkZWZhdWx0c1trZXldO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBvcHRpb25zO1xufTtcblxuLyoqXG4qIEluaXQgdGhlIHBsYXllci4gRmlndXJlIG91dCBpZiB0aGUgb2xkIHBsYXllciBzaG91bGQgYmUgbG9hZGVkIGJ5IGNoZWNraW5nIGlmIHRoZSBhdWRpbyBlbGVtZW50IGhhcyB0aGUgY2FuUGxheVR5cGUoKSBtZXRob2RcbipcbiogQG1ldGhvZCBpbml0XG4qL1xuRmFydC5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uKCkge1xuXG5cdHRoaXMuZmFydF9wbGF5ZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYXVkaW9cIik7XG5cdGlmICggdHlwZW9mICh0aGlzLmZhcnRfcGxheWVyLmNhblBsYXlUeXBlKSA9PSAndW5kZWZpbmVkJykge1xuXHRcdHRoaXMubG9hZF9vbGRfcGxheWVyKCk7XG5cdH1cblx0dGhpcy5wcmVsb2FkKCk7XG59O1xuXG4vKipcbiogSWYgdGhlIGJyb3dzZXIgaXMgdG9vIG9sZCB0byBsb2FkIGFuIEFVRElPIGVsZW1lbnQsIGl0cyBwcm9iYWJseSBpZTcvOFxuKlxuKiBAbWV0aG9kIGxvYWRfb2xkX3BsYXllclxuKi9cbkZhcnQucHJvdG90eXBlLmxvYWRfb2xkX3BsYXllciA9IGZ1bmN0aW9uKCkge1xuXHRkb2N1bWVudC5ib2R5LmlubmVySFRNTCArPSAnPGRpdiBzdHlsZT1cImRpc3BsYXk6bm9uZTtcIj48b2JqZWN0IGlkPVwiY29udGVudFBsYXllclwiIGNsYXNzaWQ9XCJDTFNJRDo2QkY1MkE1Mi0zOTRBLTExZDMtQjE1My0wMEMwNEY3OUZBQTZcIiB3aWR0aD1cIjEwMFwiIGhlaWdodD1cIjEwMFwiPjxwYXJhbSBuYW1lPVwidm9sdW1lXCIgdmFsdWU9XCIxMDAlXCIgLz48cGFyYW0gbmFtZT1cIndpbmRvd2xlc3NWaWRlb1wiIHZhbHVlPVwidHJ1ZVwiPjxwYXJhbSBuYW1lPVwiQW5pbWF0aW9uYXRTdGFydFwiIHZhbHVlPVwiMFwiIC8+PHBhcmFtIG5hbWU9XCJhdXRvc3RhcnRcIiB2YWx1ZT1cIjFcIiAvPjwvb2JqZWN0PjwvZGl2Pic7XG5cdHRoaXMuZmFydF9wbGF5ZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29udGVudFBsYXllcicpO1xuXHR0aGlzLmZhcnRfb2xkX3BsYXllciA9IHRydWU7XG59O1xuXG4vKipcbiogUGxheSB0aGUgc291bmQgdmlhIHRoZSBicm93c2VyLlxuKiBJZiBhIHZhbGlkICRzb3VuZCBpcyBwYXNzZWQsIGl0IHdpbGwgcGxheSwgb3RoZXJ3aXNlIGl0IHdpbGwgZGVmYXVsdCB0byB0aGUgZGVmYXV0IHNvdW5kXG4qXG4qIEBtZXRob2QgcGxheVxuKiBAcGFyYW0ge1N0cmluZ30gZm9vIFRoZSBuYW1lIG9mIHRoZSBzb3VuZCB0byBwbGF5XG4qIEBwYXJhbSB7U3RyaW5nfSBmb28gQSBjYWxsYmFjayBmb3Igb25jZSB0aGUgc291bmQgaGFzIGVuZGVkXG4qL1xuRmFydC5wcm90b3R5cGUucGxheSA9IGZ1bmN0aW9uKHNvdW5kLCBjYWxsYmFjaykge1xuXHR2YXIgZmFydCA9IChzb3VuZCkgPyAoZmFydHNbc291bmRdKSA/IGZhcnRzW3NvdW5kXSA6IHNvdW5kOiB0aGlzLm9wdGlvbnMuZGVmYXVsdF9zb3VuZDtcblx0Y2FsbGJhY2sgPSBjYWxsYmFjayB8fCBudWxsO1xuXHRpZiAoIXRoaXMuZmFydF9vbGRfcGxheWVyKSB7XG5cdFx0dmFyIGV4dCA9ICh0aGlzLmZhcnRfcGxheWVyLmNhblBsYXlUeXBlKCdhdWRpby9tcDMnKSkgPyAnLm1wMycgOiAnLndhdic7XG5cdFx0dGhpcy5mYXJ0X3BsYXllci5zZXRBdHRyaWJ1dGUoJ3NyYycsIFwiL3B1YmxpYy9mYXJ0cy9cIiArIGZhcnQgKyBleHQpO1xuXHRcdHRoaXMuZmFydF9wbGF5ZXIubG9vcCA9IHRoaXMub3B0aW9ucy5sb29wO1xuXHRcdHRoaXMuZmFydF9wbGF5ZXIudm9sdW1lID0gKHRoaXMub3B0aW9ucy52b2x1bWUgLyAxMDApO1xuXHRcdHRoaXMuZmFydF9wbGF5ZXIucGxheSgpO1xuXHRcdCQodGhpcy5mYXJ0X3BsYXllcikub24oXCJlbmRlZFwiLCBmdW5jdGlvbigpIHtcblx0XHRcdGlmIChjYWxsYmFjaykge1xuXHRcdFx0XHRjYWxsYmFjaygpO1xuXHRcdFx0XHQkKHRoaXMuZmFydF9wbGF5ZXIpLm9mZihcImVuZGVkXCIpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9IGVsc2Uge1xuXHRcdHRoaXMuZmFydF9wbGF5ZXIuVVJMID0gXCIvZmFydHMvXCIgKyBmYXJ0ICsgJy5tcDMnO1xuXHR9XG59O1xuXG4vKipcbiogU3RvcCB0aGUgc291bmQgZnJvbSBwbGF5aW5nXG4qXG4qIEBtZXRob2Qgc3RvcFxuKi9cbkZhcnQucHJvdG90eXBlLnN0b3AgPSBmdW5jdGlvbigpIHtcblx0dGhpcy5mYXJ0X3BsYXllci5wYXVzZSgpO1xufTtcblxuLyoqXG4qIFJlbW92ZSB0aGUgZWxlbWVudCBmcm9tIHRoZSBET01cbipcbiogQG1ldGhvZCByZW1vdmVcbiovXG5GYXJ0LnByb3RvdHlwZS5yZW1vdmUgPSBmdW5jdGlvbigpIHtcblx0dGhpcy5mYXJ0X3BsYXllci5yZW1vdmUoKTtcbn07XG5cbi8qKlxuKiBQbGF5IGEgcmFuZG9tIGZhcnQgZnJvbSB0aGUgbGlzdFxuKlxuKiBAbWV0aG9kIHJhbmRvbVxuKi9cbkZhcnQucHJvdG90eXBlLnJhbmRvbSA9IGZ1bmN0aW9uKCkge1xuXHR2YXIga2V5cyA9IE9iamVjdC5rZXlzKGZhcnRzKTtcblx0dmFyIGZhcnQgPSBrZXlzW2tleXMubGVuZ3RoICogTWF0aC5yYW5kb20oKSA8PCAwXTtcblx0dGhpcy5wbGF5KGZhcnQpO1xufTtcblxuLyoqXG4qIFRyeSBhbmQgcHJlbG9hZCB0aGUgc291bmRzLiBUaGlzIHdhcyB1c2VmdWwgd2hlbiB0aGUgc291bmQgZmlsZXMgd2hlcmUgb24gYSByZW1vdGUgc2VydmVyXG4qXG4qIEBtZXRob2QgcHJlbG9hZFxuKi9cbkZhcnQucHJvdG90eXBlLnByZWxvYWQgPSBmdW5jdGlvbigpIHtcblx0dmFyIGZhcnRfcGxheWVyID0gdGhpcy5mYXJ0X3BsYXllcjtcblx0aWYgKCF0aGlzLmZhcnRfb2xkX3BsYXllciAmJiAhRmFydC5wcmVsb2FkZWQpIHtcblxuXHRcdE9iamVjdC52YWx1ZXMoZmFydHMpLmZvckVhY2goKHZhbCkgPT4ge1xuXG5cdFx0XHR2YXIgZXh0ID0gKGZhcnRfcGxheWVyLmNhblBsYXlUeXBlKCdhdWRpby9tcDMnKSkgPyAnLm1wMycgOiAnLndhdic7XG5cdFx0XHRmYXJ0X3BsYXllci5zZXRBdHRyaWJ1dGUoJ3NyYycsIFwiL2ZhcnRzL1wiICsgdmFsICsgZXh0KTtcblx0XHRcdC8vIGNvbnNvbGUubG9nKCdwcmVsb2FkOicsdmFsKTtcblx0XHR9KTtcblx0XHRGYXJ0LnByZWxvYWRlZCA9IHRydWU7XG5cdH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0geyBGYXJ0LCBmYXJ0cyB9O1xuIiwiJ3VzZSBzdHJpY3QnO1xuXG5jb25zb2xlLmxvZygnSGVsbG8gYnJvbmt5IScpO1xuXG4vLyBTcGVjaWFsIHRoYW5rc1xuY29uc29sZS5sb2coJ1NwZWNpYWwgdGhhbmtzIHRvIGZhcnQuanMgZm9yIHRoZSBmYXJ0cyEg4oCUIGh0dHA6Ly9qc2ZhcnQuY29tJyk7XG5jb25zb2xlLmxvZygnU3BlY2lhbCB0aGFua3MgdG8gQ1NTaGFrZSBmb3IgdGhlIHNoYWtlcyEg4oCUIGh0dHBzOi8vZWxydW1vcmRlbGFsdXouZ2l0aHViLmlvL2Nzc2hha2UnKTtcblxuLy8gNCB0aGUgZGV2c1xuY29uc3QgUExBWV9GQVJUX1NPVU5EUyA9IHRydWU7XG5jb25zdCBSVU5fU0hBS0VTID0gdHJ1ZTtcblxuLy8gT1BFTklORyBTQ1JFRU4gU0hPVUxEIEJFIEJJRyBXSElURSBURVhUXG4vLyBHSU1NRSBBIEhJR0ggRklWRSEhXG4vLyBXSVRIIEJPVEggSEFORFMgSElHSCBGSVZFIEhBTkRTXG4vLyBUSEVOIEhFIFRVUk5TIElOVE8gREFOQ0lORyBCUk9OS1kgV0lUSCBZT1VSIElQIEFERFJFU1NcblxuY29uc3QgdXRpbHMgPSB7fTtcblxudXRpbHMucmFuZG9tRnJvbUFycmF5ID0gKGFycikgPT4gYXJyW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGFyci5sZW5ndGgpXTtcbnV0aWxzLnJhbmRvbUZyb21BcnJheUV4Y2VwdCA9IChhcnIsIC4uLmV4Y2VwdCkgPT4ge1xuXG4gICAgY29uc3QgZmlsdGVyZWQgPSBhcnIuZmlsdGVyKCh4KSA9PiB4ICE9PSBleGNlcHQpO1xuICAgIHJldHVybiBmaWx0ZXJlZFtNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBmaWx0ZXJlZC5sZW5ndGgpXTtcbn07XG5cbi8vIEluaXRcbmNvbnN0IGNob3NlbkZhcnRzID0gW1xuICAgIC8vICd0b290JywgLy8gVGhlcmUncyBubyB0b290IHdpdGhvdXQgdHVwcGVuY2VcbiAgICAvLyAndHVwcGVuY2UnLCAvLyBUaGVyZSdzIG5vIHR1cHBlbmNlIHdpdGhvdXQgdG9vdFxuICAgICdyaXBwZXInLFxuICAgICdyYXNwYmVycnknLFxuICAgICd0cnVtcGV0JyxcbiAgICAnd2luZHknIC8vIEFoaGgsIENoaWNhZ29cbl07XG5cbmNvbnN0IGNob3NlblNoYWtlcyA9IFtcbiAgICAnc2hha2UtaGFyZCcsXG4gICAgJ3NoYWtlLWNyYXp5J1xuXTtcblxuLy8gSW5pdCB0aGUgZmFydHMgZnJvbSBmYXJ0LmpzXG5jb25zdCB7IEZhcnQsIGZhcnRzIH0gPSByZXF1aXJlKCcuL2ZhcnQnKTtcblxuY29uc3QgZmFydCA9IG5ldyBGYXJ0KHsgdm9sdW1lOiAxMDAgfSk7XG5cbndpbmRvdy5GYXJ0ID0gRmFydDtcbndpbmRvdy5icm9ua3lGYXJ0ID0gZmFydDtcbndpbmRvdy5mYXJ0cyA9IGZhcnRzO1xuXG5jb25zdCBwbGF5RmFydCA9IChjaG9zZW5GYXJ0KSA9PiB7XG5cbiAgICBpZiAoIVBMQVlfRkFSVF9TT1VORFMpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGZhcnQucGxheShjaG9zZW5GYXJ0KTtcbn07XG5cbmNvbnN0IGJyb25reSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdicm9ua3lDb250ZW50Jyk7XG5cbi8vIEluaXQgQnJvbmt5J3Mgc2hha2VzIGZyb20gQ1NTaGFrZXNcbmNvbnN0IGluaXRTaGFrZUNsYXNzZXMgPSBbXG4gICAgJ3NoYWtlLWNvbnN0YW50JyxcbiAgICAnc2hha2Utc2xvdydcbiAgICAvLyAnc2hha2UtY29uc3RhbnQtLWhvdmVyJ1xuICAgIC8vICdzaGFrZS1mcmVlemUnXG4gICAgLy8gJ3NoYWtlLW9wYWNpdHknXG5dO1xuXG5pZiAoUlVOX1NIQUtFUykge1xuICAgIGJyb25reS5jbGFzc0xpc3QuYWRkKC4uLmluaXRTaGFrZUNsYXNzZXMpO1xufVxuXG5sZXQgaXNGYXJ0aW5nID0gZmFsc2U7XG5cbmNvbnN0IHNoYWtlQnJvbmt5ID0gKHNoYWtlLCBkdXJhdGlvbikgPT4ge1xuXG4gICAgaWYgKCFSVU5fU0hBS0VTKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpc0ZhcnRpbmcgPSB0cnVlO1xuXG4gICAgYnJvbmt5LmNsYXNzTGlzdC5yZW1vdmUoLi4uY2hvc2VuU2hha2VzKTtcblxuICAgIGJyb25reS5jbGFzc0xpc3QuYWRkKHNoYWtlKTtcblxuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuXG4gICAgICAgIGJyb25reS5jbGFzc0xpc3QucmVtb3ZlKHNoYWtlKTtcbiAgICAgICAgaXNGYXJ0aW5nID0gZmFsc2U7XG4gICAgfSwgZHVyYXRpb24gfHwgTWF0aC5yYW5kb20oKSAqIDMwMDAgKyAyMDAwKTtcbn07XG5cbmNvbnN0IG1vYmlsZVJlZ2V4ID0gL0FuZHJvaWR8d2ViT1N8aVBob25lfGlQYWR8aVBvZHxCbGFja0JlcnJ5fElFTW9iaWxlfE9wZXJhIE1pbmkvaTtcblxubGV0IGlzTW9iaWxlID0gZmFsc2U7XG5cbmlmIChtb2JpbGVSZWdleC50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpICkge1xuICAgIGlzTW9iaWxlID0gdHJ1ZTtcbn1cblxubGV0IGxhc3RGYXJ0ID0gbnVsbDtcbmxldCBsYXN0U2hha2UgPSBudWxsO1xuXG5sZXQgZm9yY2VGYXJ0ID0gbnVsbDtcblxuY29uc3QgYnJvbmt5RmFydCA9ICgpID0+IHtcblxuICAgIGNvbnN0IHNoYWtlRmFydFNldHRpbmdzID0ge1xuICAgICAgICB0b290OiB7XG4gICAgICAgICAgICBzaGFrZU5hbWVDaG9pY2VzOiBbJ3NoYWtlLWxpdHRsZScsICdzaGFrZS1yb3RhdGUnXSxcbiAgICAgICAgICAgIGR1cmF0aW9uOiAxMDAwXG4gICAgICAgIH0sXG4gICAgICAgIHR1cHBlbmNlOiB7XG4gICAgICAgICAgICBzaGFrZU5hbWVDaG9pY2VzOiBbJ3NoYWtlLWxpdHRsZScsICdzaGFrZS1yb3RhdGUnXSxcbiAgICAgICAgICAgIGR1cmF0aW9uOiAxMDAwXG4gICAgICAgIH0sXG4gICAgICAgIHJpcHBlcjoge1xuICAgICAgICAgICAgc2hha2VOYW1lQ2hvaWNlczogWydzaGFrZS1oYXJkJywgJ3NoYWtlLXZlcnRpY2FsJ10sXG4gICAgICAgICAgICBkdXJhdGlvbjogMTUwMFxuICAgICAgICB9LFxuICAgICAgICByYXNwYmVycnk6IHtcbiAgICAgICAgICAgIHNoYWtlTmFtZUNob2ljZXM6IFsnc2hha2UtY3JhenknLCAnc2hha2Utcm90YXRlJ10sXG4gICAgICAgICAgICBkdXJhdGlvbjogMjAwMFxuICAgICAgICB9LFxuICAgICAgICB0cnVtcGV0OiB7XG4gICAgICAgICAgICBzaGFrZU5hbWVDaG9pY2VzOiBbJ3NoYWtlLWhhcmQnLCAnc2hha2UtY3JhenknLCAnc2hha2Utcm90YXRlJ10sXG4gICAgICAgICAgICBkdXJhdGlvbjogMTQwMFxuICAgICAgICB9LFxuICAgICAgICB3aW5keToge1xuICAgICAgICAgICAgc2hha2VOYW1lQ2hvaWNlczogWydzaGFrZS1oYXJkJywgJ3NoYWtlLXJvdGF0ZSddLFxuICAgICAgICAgICAgZHVyYXRpb246IDU4MDBcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBjb25zdCByYW5kb21GYXJ0ID0gZm9yY2VGYXJ0ID8gZm9yY2VGYXJ0IDogdXRpbHMucmFuZG9tRnJvbUFycmF5RXhjZXB0KGNob3NlbkZhcnRzLCBsYXN0RmFydCkgfHwgJ3Jhc3BiZXJyeSc7XG5cbiAgICBpZiAoZm9yY2VGYXJ0KSB7XG4gICAgICAgIGZvcmNlRmFydCA9IG51bGw7XG4gICAgfVxuXG4gICAgbGFzdEZhcnQgPSByYW5kb21GYXJ0O1xuXG4gICAgY29uc3QgeyBzaGFrZU5hbWVDaG9pY2VzLCBkdXJhdGlvbiB9ID0gc2hha2VGYXJ0U2V0dGluZ3NbcmFuZG9tRmFydF07XG5cbiAgICBwbGF5RmFydChyYW5kb21GYXJ0KTtcblxuICAgIGNvbnN0IEFVRElPX0xPQURfVElNRU9VVCA9IGlzTW9iaWxlID8gMjAwIDogNDAwO1xuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuXG4gICAgICAgIGNvbnN0IHJhbmRvbVNoYWtlID0gdXRpbHMucmFuZG9tRnJvbUFycmF5RXhjZXB0KFtdLmNvbmNhdChzaGFrZU5hbWVDaG9pY2VzKSwgbGFzdFNoYWtlKSB8fCAnc2hha2Utcm90YXRlJztcblxuICAgICAgICBsYXN0U2hha2UgPSByYW5kb21TaGFrZTtcblxuICAgICAgICBzaGFrZUJyb25reShcbiAgICAgICAgICAgIHJhbmRvbVNoYWtlLFxuICAgICAgICAgICAgZHVyYXRpb25cbiAgICAgICAgKTtcbiAgICB9LCBBVURJT19MT0FEX1RJTUVPVVQpO1xufTtcblxuY29uc3Qgb2tTdG9wVGhlRmFydHMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb2tTdG9wVGhlRmFydHNCdG4nKTtcblxuaWYgKGlzTW9iaWxlKSB7XG4gICAgY29uc29sZS5sb2coJ2lzTW9iaWxlJywgaXNNb2JpbGUpO1xuICAgIG9rU3RvcFRoZUZhcnRzLnN0eWxlLnBhZGRpbmcgPSAnMjAwcHgnO1xufVxuXG4vLyBQb3NpdGlvbiB0aGUgaXAgYWRkcmVzcyBkaXZcblxuY29uc3QgaXNMb2NhbCA9IHdpbmRvdy5sb2NhdGlvbi5ob3N0LnN0YXJ0c1dpdGgoJ2xvY2FsaG9zdDonKTtcbmNvbnN0IGlzQnJvbmt5ID0gd2luZG93LmxvY2F0aW9uLmhvc3QgPT09ICdicm9ua3ljaGFybGVzLmNvbSc7XG5jb25zdCBpc0Jyb25rb25pb3VzID0gd2luZG93LmxvY2F0aW9uLmhvc3QgPT09ICdicm9ua29uaW91c2NoYXJsZXN0b24uY29tJztcblxuY29uc3QgdXJJcCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd1cmlwJyk7XG5cbnVySXAuc3R5bGUudG9wID0gJzE1MHB4JztcblxuaWYgKGlzTG9jYWwgfHwgaXNCcm9ua3kpIHtcbiAgICB1cklwLnN0eWxlLmxlZnQgPSAnMTUwcHgnO1xuICAgIHVySXAuc3R5bGUudHJhbnNmb3JtID0gJ3JvdGF0ZSgtNDVkZWcpJztcbn1cbmVsc2UgaWYgKGlzQnJvbmtvbmlvdXMpIHtcbiAgICB1cklwLnN0eWxlLnJpZ2h0ID0gJzE1MHB4JztcbiAgICB1cklwLnN0eWxlLnRyYW5zZm9ybSA9ICdyb3RhdGUoNDVkZWcpJztcbn1cblxuLy8gSW5pdCB0aGUgd2VicGFnZSBwbGF5aW5nIGEgZmFydCBpbiBjYXNlIHRoYXQgd29ya3MuXG4vLyBOb3JtYWxseSB0aGUgdXNlciBoYXMgdG8gaW50ZXJhY3Qgd2l0aCB0aGUgZG9jdW1lbnQgYmVmb3JlXG4vLyBhIHNvdW5kIGNhbiBiZSBwbGF5ZWQuXG4vLyBBdCBsZWFzdCB3ZSdsbCBzaGFrZSBicm9ua3kgbG9MXG5icm9ua3lGYXJ0KCk7XG5cbnNldEludGVydmFsKCgpID0+IHtcblxuICAgIGlmICghaXNGYXJ0aW5nKSB7XG4gICAgICAgIGJyb25reUZhcnQoKTtcbiAgICB9XG59LCAxMDAwMCk7XG5cbmRvY3VtZW50Lm9uY2xpY2sgPSAoKSA9PiB7XG5cbiAgICBmb3JjZUZhcnQgPSAndHJ1bXBldCc7XG4gICAgYnJvbmt5RmFydCgpO1xufTtcblxuLy8gTGl2ZSBjaGF0XG5cbi8vXG4iXX0=
