(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
'use strict';
/**
 *
 * fart.js
 * A javascript library for adding fart sounds to your web experience
 *
 *
 * @author 	Tel Smith
 * @tweet 	@74656c
 * @web 	http://jsfart.com/
 * @github 	https://github.com/74656c/fart.js/
 *
 * version 2.0.0
 *
 * Remove need for jQuery for actual plugin
 *
 *
 */

/**
 * Here are the main fart sounds.
 * fart name : fart file (minus extension)
 */

var farts = {
  toot: 'fart1',
  ripper: 'fart2',
  plop: 'fart3',
  squit: 'fart4',
  raspberry: 'fart5',
  squat: 'fart6',
  tuppence: 'fart7',
  liftoff: 'fart8',
  trumpet: 'fart9',
  fizzler: 'fart10',
  windy: 'fart11',
  eine: 'fart12',
  fartception: 'fart13',
  fartpoint1: 'fart14'
};
/**
* This is the Fart constructor.
*
* @class Fart
* @constructor
*
* @param {Object} options Default Sound, Loop and Volume
*/

function Fart(options) {
  this.sound = this.default_sound;
  this.fart_player = null;
  this.old_player = false;
  this.options = this.fartxtend({
    default_sound: farts.raspberry,
    loop: false,
    volume: 50 // 0 - 100

  }, options);
  this.init();
}

Fart.preloaded = false;
/**
 *
 * Mimic jQuery Extend. 			✓
 * Change name for Fart-based LOL. 	✓
 *
 */

Fart.prototype.fartxtend = function (options, defaults) {
  for (var key in defaults) {
    if (defaults.hasOwnProperty(key)) {
      options[key] = defaults[key];
    }
  }

  return options;
};
/**
* Init the player. Figure out if the old player should be loaded by checking if the audio element has the canPlayType() method
*
* @method init
*/


Fart.prototype.init = function () {
  this.fart_player = document.createElement("audio");

  if (typeof this.fart_player.canPlayType == 'undefined') {
    this.load_old_player();
  }

  this.preload();
};
/**
* If the browser is too old to load an AUDIO element, its probably ie7/8
*
* @method load_old_player
*/


Fart.prototype.load_old_player = function () {
  document.body.innerHTML += '<div style="display:none;"><object id="contentPlayer" classid="CLSID:6BF52A52-394A-11d3-B153-00C04F79FAA6" width="100" height="100"><param name="volume" value="100%" /><param name="windowlessVideo" value="true"><param name="AnimationatStart" value="0" /><param name="autostart" value="1" /></object></div>';
  this.fart_player = document.getElementById('contentPlayer');
  this.fart_old_player = true;
};
/**
* Play the sound via the browser.
* If a valid $sound is passed, it will play, otherwise it will default to the defaut sound
*
* @method play
* @param {String} foo The name of the sound to play
* @param {String} foo A callback for once the sound has ended
*/


Fart.prototype.play = function (sound, callback) {
  var fart = sound ? farts[sound] ? farts[sound] : sound : this.options.default_sound;
  callback = callback || null;

  if (!this.fart_old_player) {
    var ext = this.fart_player.canPlayType('audio/mp3') ? '.mp3' : '.wav';
    this.fart_player.setAttribute('src', "/public/farts/" + fart + ext);
    this.fart_player.loop = this.options.loop;
    this.fart_player.volume = this.options.volume / 100;
    this.fart_player.play();
    $(this.fart_player).on("ended", function () {
      if (callback) {
        callback();
        $(this.fart_player).off("ended");
      }
    });
  } else {
    this.fart_player.URL = "/farts/" + fart + '.mp3';
  }
};
/**
* Stop the sound from playing
*
* @method stop
*/


Fart.prototype.stop = function () {
  this.fart_player.pause();
};
/**
* Remove the element from the DOM
*
* @method remove
*/


Fart.prototype.remove = function () {
  this.fart_player.remove();
};
/**
* Play a random fart from the list
*
* @method random
*/


Fart.prototype.random = function () {
  var keys = Object.keys(farts);
  var fart = keys[keys.length * Math.random() << 0];
  this.play(fart);
};
/**
* Try and preload the sounds. This was useful when the sound files where on a remote server
*
* @method preload
*/


Fart.prototype.preload = function () {
  var fart_player = this.fart_player;

  if (!this.fart_old_player && !Fart.preloaded) {
    Object.values(farts).forEach(function (val) {
      var ext = fart_player.canPlayType('audio/mp3') ? '.mp3' : '.wav';
      fart_player.setAttribute('src', "/farts/" + val + ext); // console.log('preload:',val);
    });
    Fart.preloaded = true;
  }
};

module.exports = {
  Fart: Fart,
  farts: farts
};

},{}],2:[function(require,module,exports){
'use strict';

console.log('Hello bronky!'); // Special thanks

console.log('Special thanks to fart.js for the farts! — http://jsfart.com');
console.log('Special thanks to CSShake for the shakes! — https://elrumordelaluz.github.io/csshake'); // 4 the devs

var PLAY_FART_SOUNDS = true;
var RUN_SHAKES = true; // OPENING SCREEN SHOULD BE BIG WHITE TEXT
// GIMME A HIGH FIVE!!
// WITH BOTH HANDS HIGH FIVE HANDS
// THEN HE TURNS INTO DANCING BRONKY WITH YOUR IP ADDRESS

var utils = {};

utils.randomFromArray = function (arr) {
  return arr[Math.floor(Math.random() * arr.length)];
};

utils.randomFromArrayExcept = function (arr) {
  for (var _len = arguments.length, except = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
    except[_key - 1] = arguments[_key];
  }

  var filtered = arr.filter(function (x) {
    return x !== except;
  });
  return filtered[Math.floor(Math.random() * filtered.length)];
}; // Init


var chosenFarts = [// 'toot', // There's no toot without tuppence
// 'tuppence', // There's no tuppence without toot
'ripper', 'raspberry', 'trumpet', 'windy' // Ahhh, Chicago
];
var chosenShakes = ['shake-hard', 'shake-crazy']; // Init the farts from fart.js

var _require = require('./fart'),
    Fart = _require.Fart,
    farts = _require.farts;

var fart = new Fart({
  volume: 100
});
window.Fart = Fart;
window.bronkyFart = fart;
window.farts = farts;

var playFart = function playFart(chosenFart) {
  if (!PLAY_FART_SOUNDS) {
    return;
  }

  fart.play(chosenFart);
};

var bronky = document.getElementById('bronkyContent'); // Init Bronky's shakes from CSShakes

var initShakeClasses = ['shake-constant', 'shake-slow' // 'shake-constant--hover'
// 'shake-freeze'
// 'shake-opacity'
];

if (RUN_SHAKES) {
  var _bronky$classList;

  (_bronky$classList = bronky.classList).add.apply(_bronky$classList, initShakeClasses);
}

var isFarting = false;

var shakeBronky = function shakeBronky(shake, duration) {
  var _bronky$classList2;

  if (!RUN_SHAKES) {
    return;
  }

  isFarting = true;

  (_bronky$classList2 = bronky.classList).remove.apply(_bronky$classList2, chosenShakes);

  bronky.classList.add(shake);
  setTimeout(function () {
    bronky.classList.remove(shake);
    isFarting = false;
  }, duration || Math.random() * 3000 + 2000);
};

var mobileRegex = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i;
var isMobile = false;

if (mobileRegex.test(navigator.userAgent)) {
  isMobile = true;
}

var lastFart = null;
var lastShake = null;

var bronkyFart = function bronkyFart() {
  var shakeFartSettings = {
    toot: {
      shakeNameChoices: ['shake-little', 'shake-rotate'],
      duration: 1000
    },
    tuppence: {
      shakeNameChoices: ['shake-little', 'shake-rotate'],
      duration: 1000
    },
    ripper: {
      shakeNameChoices: ['shake-hard', 'shake-vertical'],
      duration: 1500
    },
    raspberry: {
      shakeNameChoices: ['shake-crazy', 'shake-rotate'],
      duration: 2000
    },
    trumpet: {
      shakeNameChoices: ['shake-hard', 'shake-crazy', 'shake-rotate'],
      duration: 1400
    },
    windy: {
      shakeNameChoices: ['shake-hard', 'shake-rotate'],
      duration: 5800
    }
  };
  var randomFart = utils.randomFromArrayExcept(chosenFarts, lastFart) || 'raspberry';
  lastFart = randomFart;
  var _shakeFartSettings$ra = shakeFartSettings[randomFart],
      shakeNameChoices = _shakeFartSettings$ra.shakeNameChoices,
      duration = _shakeFartSettings$ra.duration;
  playFart(randomFart);
  var AUDIO_LOAD_TIMEOUT = isMobile ? 200 : 400;
  setTimeout(function () {
    var randomShake = utils.randomFromArrayExcept([].concat(shakeNameChoices), lastShake) || 'shake-rotate';
    lastShake = randomShake;
    shakeBronky(randomShake, duration);
  }, AUDIO_LOAD_TIMEOUT);
};

var okStopTheFarts = document.getElementById('okStopTheFartsBtn');

if (isMobile) {
  console.log('isMobile', isMobile);
  okStopTheFarts.style.padding = '200px';
} // Position the ip address div


var isLocal = window.location.host.startsWith('localhost:');
var isBronky = window.location.host === 'bronkycharles.com';
var isBronkonious = window.location.host === 'bronkoniouscharleston.com';
var urIp = document.getElementById('urip');
urIp.style.top = '175px';

if (isLocal || isBronky) {
  urIp.style.left = '150px';
  urIp.style.transform = 'rotate(-45deg)';
} else if (isBronkonious) {
  urIp.style.right = '150px';
  urIp.style.transform = 'rotate(45deg)';
} // Init the webpage playing a fart in case that works.
// Normally the user has to interact with the document before
// a sound can be played.
// At least we'll shake bronky loL


bronkyFart();
setInterval(function () {
  if (!isFarting) {
    bronkyFart();
  }
}, 10000);
document.onclick = bronkyFart; // Live chat
//

},{"./fart":1}]},{},[2])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJsaWIvcHVibGljL2pzL2ZhcnQuanMiLCJsaWIvcHVibGljL2pzL21haW4uanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsSUFBTSxLQUFLLEdBQUc7QUFDYixFQUFBLElBQUksRUFBRSxPQURPO0FBRWIsRUFBQSxNQUFNLEVBQUUsT0FGSztBQUdiLEVBQUEsSUFBSSxFQUFFLE9BSE87QUFJYixFQUFBLEtBQUssRUFBRSxPQUpNO0FBS2IsRUFBQSxTQUFTLEVBQUUsT0FMRTtBQU1iLEVBQUEsS0FBSyxFQUFFLE9BTk07QUFPYixFQUFBLFFBQVEsRUFBRSxPQVBHO0FBUWIsRUFBQSxPQUFPLEVBQUUsT0FSSTtBQVNiLEVBQUEsT0FBTyxFQUFFLE9BVEk7QUFVYixFQUFBLE9BQU8sRUFBRSxRQVZJO0FBV2IsRUFBQSxLQUFLLEVBQUUsUUFYTTtBQVliLEVBQUEsSUFBSSxFQUFFLFFBWk87QUFhYixFQUFBLFdBQVcsRUFBRSxRQWJBO0FBY2IsRUFBQSxVQUFVLEVBQUU7QUFkQyxDQUFkO0FBaUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBQ0EsU0FBUyxJQUFULENBQWMsT0FBZCxFQUF1QjtBQUN0QixPQUFLLEtBQUwsR0FBYSxLQUFLLGFBQWxCO0FBQ0EsT0FBSyxXQUFMLEdBQW1CLElBQW5CO0FBQ0EsT0FBSyxVQUFMLEdBQWtCLEtBQWxCO0FBQ0EsT0FBSyxPQUFMLEdBQWUsS0FBSyxTQUFMLENBQWU7QUFDN0IsSUFBQSxhQUFhLEVBQUcsS0FBSyxDQUFDLFNBRE87QUFFN0IsSUFBQSxJQUFJLEVBQUcsS0FGc0I7QUFHN0IsSUFBQSxNQUFN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Qjs7QUFFQSxJQUFJLE9BQU8sSUFBSSxRQUFmLEVBQXlCO0FBQ3JCLEVBQUEsSUFBSSxDQUFDLEtBQUwsQ0FBVyxJQUFYLEdBQWtCLE9BQWxCO0FBQ0EsRUFBQSxJQUFJLENBQUMsS0FBTCxDQUFXLFNBQVgsR0FBdUIsZ0JBQXZCO0FBQ0gsQ0FIRCxNQUlLLElBQUksYUFBSixFQUFtQjtBQUNwQixFQUFBLElBQUksQ0FBQyxLQUFMLENBQVcsS0FBWCxHQUFtQixPQUFuQjtBQUNBLEVBQUEsSUFBSSxDQUFDLEtBQUwsQ0FBVyxTQUFYLEdBQXVCLGVBQXZCO0FBQ0gsQyxDQUVEO0FBQ0E7QUFDQTtBQUNBOzs7QUFDQSxVQUFVO0FBRVYsV0FBVyxDQUFDLFlBQU07QUFFZCxNQUFJLENBQUMsU0FBTCxFQUFnQjtBQUNaLElBQUEsVUFBVTtBQUNiO0FBQ0osQ0FMVSxFQUtSLEtBTFEsQ0FBWDtBQU9BLFFBQVEsQ0FBQyxPQUFULEdBQW1CLFVBQW5CLEMsQ0FFQTtBQUVBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24oKXtmdW5jdGlvbiByKGUsbix0KXtmdW5jdGlvbiBvKGksZil7aWYoIW5baV0pe2lmKCFlW2ldKXt2YXIgYz1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlO2lmKCFmJiZjKXJldHVybiBjKGksITApO2lmKHUpcmV0dXJuIHUoaSwhMCk7dmFyIGE9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitpK1wiJ1wiKTt0aHJvdyBhLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsYX12YXIgcD1uW2ldPXtleHBvcnRzOnt9fTtlW2ldWzBdLmNhbGwocC5leHBvcnRzLGZ1bmN0aW9uKHIpe3ZhciBuPWVbaV1bMV1bcl07cmV0dXJuIG8obnx8cil9LHAscC5leHBvcnRzLHIsZSxuLHQpfXJldHVybiBuW2ldLmV4cG9ydHN9Zm9yKHZhciB1PVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmUsaT0wO2k8dC5sZW5ndGg7aSsrKW8odFtpXSk7cmV0dXJuIG99cmV0dXJuIHJ9KSgpIiwiJ3VzZSBzdHJpY3QnO1xuXG4vKipcbiAqXG4gKiBmYXJ0LmpzXG4gKiBBIGphdmFzY3JpcHQgbGlicmFyeSBmb3IgYWRkaW5nIGZhcnQgc291bmRzIHRvIHlvdXIgd2ViIGV4cGVyaWVuY2VcbiAqXG4gKlxuICogQGF1dGhvciBcdFRlbCBTbWl0aFxuICogQHR3ZWV0IFx0QDc0NjU2Y1xuICogQHdlYiBcdGh0dHA6Ly9qc2ZhcnQuY29tL1xuICogQGdpdGh1YiBcdGh0dHBzOi8vZ2l0aHViLmNvbS83NDY1NmMvZmFydC5qcy9cbiAqXG4gKiB2ZXJzaW9uIDIuMC4wXG4gKlxuICogUmVtb3ZlIG5lZWQgZm9yIGpRdWVyeSBmb3IgYWN0dWFsIHBsdWdpblxuICpcbiAqXG4gKi9cblxuXG4vKipcbiAqIEhlcmUgYXJlIHRoZSBtYWluIGZhcnQgc291bmRzLlxuICogZmFydCBuYW1lIDogZmFydCBmaWxlIChtaW51cyBleHRlbnNpb24pXG4gKi9cblxuY29uc3QgZmFydHMgPSB7XG5cdHRvb3Q6ICdmYXJ0MScsXG5cdHJpcHBlcjogJ2ZhcnQyJyxcblx0cGxvcDogJ2ZhcnQzJyxcblx0c3F1aXQ6ICdmYXJ0NCcsXG5cdHJhc3BiZXJyeTogJ2ZhcnQ1Jyxcblx0c3F1YXQ6ICdmYXJ0NicsXG5cdHR1cHBlbmNlOiAnZmFydDcnLFxuXHRsaWZ0b2ZmOiAnZmFydDgnLFxuXHR0cnVtcGV0OiAnZmFydDknLFxuXHRmaXp6bGVyOiAnZmFydDEwJyxcblx0d2luZHk6ICdmYXJ0MTEnLFxuXHRlaW5lOiAnZmFydDEyJyxcblx0ZmFydGNlcHRpb246ICdmYXJ0MTMnLFxuXHRmYXJ0cG9pbnQxOiAnZmFydDE0J1xufTtcblxuLyoqXG4qIFRoaXMgaXMgdGhlIEZhcnQgY29uc3RydWN0b3IuXG4qXG4qIEBjbGFzcyBGYXJ0XG4qIEBjb25zdHJ1Y3RvclxuKlxuKiBAcGFyYW0ge09iamVjdH0gb3B0aW9ucyBEZWZhdWx0IFNvdW5kLCBMb29wIGFuZCBWb2x1bWVcbiovXG5mdW5jdGlvbiBGYXJ0KG9wdGlvbnMpIHtcblx0dGhpcy5zb3VuZCA9IHRoaXMuZGVmYXVsdF9zb3VuZDtcblx0dGhpcy5mYXJ0X3BsYXllciA9IG51bGw7XG5cdHRoaXMub2xkX3BsYXllciA9IGZhbHNlO1xuXHR0aGlzLm9wdGlvbnMgPSB0aGlzLmZhcnR4dGVuZCh7XG5cdFx0ZGVmYXVsdF9zb3VuZCA6IGZhcnRzLnJhc3BiZXJyeSxcblx0XHRsb29wIDogZmFsc2UsXG5cdFx0dm9sdW1lIDogNTBcdC8vIDAgLSAxMDBcblx0fSwgb3B0aW9ucyk7XG5cdHRoaXMuaW5pdCgpO1xufVxuRmFydC5wcmVsb2FkZWQgPSBmYWxzZTtcblxuLyoqXG4gKlxuICogTWltaWMgalF1ZXJ5IEV4dGVuZC4gXHRcdFx04pyTXG4gKiBDaGFuZ2UgbmFtZSBmb3IgRmFydC1iYXNlZCBMT0wuIFx04pyTXG4gKlxuICovXG5GYXJ0LnByb3RvdHlwZS5mYXJ0eHRlbmQgPSBmdW5jdGlvbihvcHRpb25zLCBkZWZhdWx0cykge1xuICAgIGZvcih2YXIga2V5IGluIGRlZmF1bHRzKXtcbiAgICAgICAgaWYoZGVmYXVsdHMuaGFzT3duUHJvcGVydHkoa2V5KSl7XG4gICAgICAgIFx0b3B0aW9uc1trZXldID0gZGVmYXVsdHNba2V5XTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gb3B0aW9ucztcbn07XG5cbi8qKlxuKiBJbml0IHRoZSBwbGF5ZXIuIEZpZ3VyZSBvdXQgaWYgdGhlIG9sZCBwbGF5ZXIgc2hvdWxkIGJlIGxvYWRlZCBieSBjaGVja2luZyBpZiB0aGUgYXVkaW8gZWxlbWVudCBoYXMgdGhlIGNhblBsYXlUeXBlKCkgbWV0aG9kXG4qXG4qIEBtZXRob2QgaW5pdFxuKi9cbkZhcnQucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbigpIHtcblxuXHR0aGlzLmZhcnRfcGxheWVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImF1ZGlvXCIpO1xuXHRpZiAoIHR5cGVvZiAodGhpcy5mYXJ0X3BsYXllci5jYW5QbGF5VHlwZSkgPT0gJ3VuZGVmaW5lZCcpIHtcblx0XHR0aGlzLmxvYWRfb2xkX3BsYXllcigpO1xuXHR9XG5cdHRoaXMucHJlbG9hZCgpO1xufTtcblxuLyoqXG4qIElmIHRoZSBicm93c2VyIGlzIHRvbyBvbGQgdG8gbG9hZCBhbiBBVURJTyBlbGVtZW50LCBpdHMgcHJvYmFibHkgaWU3LzhcbipcbiogQG1ldGhvZCBsb2FkX29sZF9wbGF5ZXJcbiovXG5GYXJ0LnByb3RvdHlwZS5sb2FkX29sZF9wbGF5ZXIgPSBmdW5jdGlvbigpIHtcblx0ZG9jdW1lbnQuYm9keS5pbm5lckhUTUwgKz0gJzxkaXYgc3R5bGU9XCJkaXNwbGF5Om5vbmU7XCI+PG9iamVjdCBpZD1cImNvbnRlbnRQbGF5ZXJcIiBjbGFzc2lkPVwiQ0xTSUQ6NkJGNTJBNTItMzk0QS0xMWQzLUIxNTMtMDBDMDRGNzlGQUE2XCIgd2lkdGg9XCIxMDBcIiBoZWlnaHQ9XCIxMDBcIj48cGFyYW0gbmFtZT1cInZvbHVtZVwiIHZhbHVlPVwiMTAwJVwiIC8+PHBhcmFtIG5hbWU9XCJ3aW5kb3dsZXNzVmlkZW9cIiB2YWx1ZT1cInRydWVcIj48cGFyYW0gbmFtZT1cIkFuaW1hdGlvbmF0U3RhcnRcIiB2YWx1ZT1cIjBcIiAvPjxwYXJhbSBuYW1lPVwiYXV0b3N0YXJ0XCIgdmFsdWU9XCIxXCIgLz48L29iamVjdD48L2Rpdj4nO1xuXHR0aGlzLmZhcnRfcGxheWVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvbnRlbnRQbGF5ZXInKTtcblx0dGhpcy5mYXJ0X29sZF9wbGF5ZXIgPSB0cnVlO1xufTtcblxuLyoqXG4qIFBsYXkgdGhlIHNvdW5kIHZpYSB0aGUgYnJvd3Nlci5cbiogSWYgYSB2YWxpZCAkc291bmQgaXMgcGFzc2VkLCBpdCB3aWxsIHBsYXksIG90aGVyd2lzZSBpdCB3aWxsIGRlZmF1bHQgdG8gdGhlIGRlZmF1dCBzb3VuZFxuKlxuKiBAbWV0aG9kIHBsYXlcbiogQHBhcmFtIHtTdHJpbmd9IGZvbyBUaGUgbmFtZSBvZiB0aGUgc291bmQgdG8gcGxheVxuKiBAcGFyYW0ge1N0cmluZ30gZm9vIEEgY2FsbGJhY2sgZm9yIG9uY2UgdGhlIHNvdW5kIGhhcyBlbmRlZFxuKi9cbkZhcnQucHJvdG90eXBlLnBsYXkgPSBmdW5jdGlvbihzb3VuZCwgY2FsbGJhY2spIHtcblx0dmFyIGZhcnQgPSAoc291bmQpID8gKGZhcnRzW3NvdW5kXSkgPyBmYXJ0c1tzb3VuZF0gOiBzb3VuZDogdGhpcy5vcHRpb25zLmRlZmF1bHRfc291bmQ7XG5cdGNhbGxiYWNrID0gY2FsbGJhY2sgfHwgbnVsbDtcblx0aWYgKCF0aGlzLmZhcnRfb2xkX3BsYXllcikge1xuXHRcdHZhciBleHQgPSAodGhpcy5mYXJ0X3BsYXllci5jYW5QbGF5VHlwZSgnYXVkaW8vbXAzJykpID8gJy5tcDMnIDogJy53YXYnO1xuXHRcdHRoaXMuZmFydF9wbGF5ZXIuc2V0QXR0cmlidXRlKCdzcmMnLCBcIi9wdWJsaWMvZmFydHMvXCIgKyBmYXJ0ICsgZXh0KTtcblx0XHR0aGlzLmZhcnRfcGxheWVyLmxvb3AgPSB0aGlzLm9wdGlvbnMubG9vcDtcblx0XHR0aGlzLmZhcnRfcGxheWVyLnZvbHVtZSA9ICh0aGlzLm9wdGlvbnMudm9sdW1lIC8gMTAwKTtcblx0XHR0aGlzLmZhcnRfcGxheWVyLnBsYXkoKTtcblx0XHQkKHRoaXMuZmFydF9wbGF5ZXIpLm9uKFwiZW5kZWRcIiwgZnVuY3Rpb24oKSB7XG5cdFx0XHRpZiAoY2FsbGJhY2spIHtcblx0XHRcdFx0Y2FsbGJhY2soKTtcblx0XHRcdFx0JCh0aGlzLmZhcnRfcGxheWVyKS5vZmYoXCJlbmRlZFwiKTtcblx0XHRcdH1cblx0XHR9KTtcblx0fSBlbHNlIHtcblx0XHR0aGlzLmZhcnRfcGxheWVyLlVSTCA9IFwiL2ZhcnRzL1wiICsgZmFydCArICcubXAzJztcblx0fVxufTtcblxuLyoqXG4qIFN0b3AgdGhlIHNvdW5kIGZyb20gcGxheWluZ1xuKlxuKiBAbWV0aG9kIHN0b3BcbiovXG5GYXJ0LnByb3RvdHlwZS5zdG9wID0gZnVuY3Rpb24oKSB7XG5cdHRoaXMuZmFydF9wbGF5ZXIucGF1c2UoKTtcbn07XG5cbi8qKlxuKiBSZW1vdmUgdGhlIGVsZW1lbnQgZnJvbSB0aGUgRE9NXG4qXG4qIEBtZXRob2QgcmVtb3ZlXG4qL1xuRmFydC5wcm90b3R5cGUucmVtb3ZlID0gZnVuY3Rpb24oKSB7XG5cdHRoaXMuZmFydF9wbGF5ZXIucmVtb3ZlKCk7XG59O1xuXG4vKipcbiogUGxheSBhIHJhbmRvbSBmYXJ0IGZyb20gdGhlIGxpc3RcbipcbiogQG1ldGhvZCByYW5kb21cbiovXG5GYXJ0LnByb3RvdHlwZS5yYW5kb20gPSBmdW5jdGlvbigpIHtcblx0dmFyIGtleXMgPSBPYmplY3Qua2V5cyhmYXJ0cyk7XG5cdHZhciBmYXJ0ID0ga2V5c1trZXlzLmxlbmd0aCAqIE1hdGgucmFuZG9tKCkgPDwgMF07XG5cdHRoaXMucGxheShmYXJ0KTtcbn07XG5cbi8qKlxuKiBUcnkgYW5kIHByZWxvYWQgdGhlIHNvdW5kcy4gVGhpcyB3YXMgdXNlZnVsIHdoZW4gdGhlIHNvdW5kIGZpbGVzIHdoZXJlIG9uIGEgcmVtb3RlIHNlcnZlclxuKlxuKiBAbWV0aG9kIHByZWxvYWRcbiovXG5GYXJ0LnByb3RvdHlwZS5wcmVsb2FkID0gZnVuY3Rpb24oKSB7XG5cdHZhciBmYXJ0X3BsYXllciA9IHRoaXMuZmFydF9wbGF5ZXI7XG5cdGlmICghdGhpcy5mYXJ0X29sZF9wbGF5ZXIgJiYgIUZhcnQucHJlbG9hZGVkKSB7XG5cblx0XHRPYmplY3QudmFsdWVzKGZhcnRzKS5mb3JFYWNoKCh2YWwpID0+IHtcblxuXHRcdFx0dmFyIGV4dCA9IChmYXJ0X3BsYXllci5jYW5QbGF5VHlwZSgnYXVkaW8vbXAzJykpID8gJy5tcDMnIDogJy53YXYnO1xuXHRcdFx0ZmFydF9wbGF5ZXIuc2V0QXR0cmlidXRlKCdzcmMnLCBcIi9mYXJ0cy9cIiArIHZhbCArIGV4dCk7XG5cdFx0XHQvLyBjb25zb2xlLmxvZygncHJlbG9hZDonLHZhbCk7XG5cdFx0fSk7XG5cdFx0RmFydC5wcmVsb2FkZWQgPSB0cnVlO1xuXHR9XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IHsgRmFydCwgZmFydHMgfTtcbiIsIid1c2Ugc3RyaWN0JztcblxuY29uc29sZS5sb2coJ0hlbGxvIGJyb25reSEnKTtcblxuLy8gU3BlY2lhbCB0aGFua3NcbmNvbnNvbGUubG9nKCdTcGVjaWFsIHRoYW5rcyB0byBmYXJ0LmpzIGZvciB0aGUgZmFydHMhIOKAlCBodHRwOi8vanNmYXJ0LmNvbScpO1xuY29uc29sZS5sb2coJ1NwZWNpYWwgdGhhbmtzIHRvIENTU2hha2UgZm9yIHRoZSBzaGFrZXMhIOKAlCBodHRwczovL2VscnVtb3JkZWxhbHV6LmdpdGh1Yi5pby9jc3NoYWtlJyk7XG5cbi8vIDQgdGhlIGRldnNcbmNvbnN0IFBMQVlfRkFSVF9TT1VORFMgPSB0cnVlO1xuY29uc3QgUlVOX1NIQUtFUyA9IHRydWU7XG5cbi8vIE9QRU5JTkcgU0NSRUVOIFNIT1VMRCBCRSBCSUcgV0hJVEUgVEVYVFxuLy8gR0lNTUUgQSBISUdIIEZJVkUhIVxuLy8gV0lUSCBCT1RIIEhBTkRTIEhJR0ggRklWRSBIQU5EU1xuLy8gVEhFTiBIRSBUVVJOUyBJTlRPIERBTkNJTkcgQlJPTktZIFdJVEggWU9VUiBJUCBBRERSRVNTXG5cbmNvbnN0IHV0aWxzID0ge307XG5cbnV0aWxzLnJhbmRvbUZyb21BcnJheSA9IChhcnIpID0+IGFycltNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBhcnIubGVuZ3RoKV07XG51dGlscy5yYW5kb21Gcm9tQXJyYXlFeGNlcHQgPSAoYXJyLCAuLi5leGNlcHQpID0+IHtcblxuICAgIGNvbnN0IGZpbHRlcmVkID0gYXJyLmZpbHRlcigoeCkgPT4geCAhPT0gZXhjZXB0KTtcbiAgICByZXR1cm4gZmlsdGVyZWRbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogZmlsdGVyZWQubGVuZ3RoKV07XG59O1xuXG4vLyBJbml0XG5jb25zdCBjaG9zZW5GYXJ0cyA9IFtcbiAgICAvLyAndG9vdCcsIC8vIFRoZXJlJ3Mgbm8gdG9vdCB3aXRob3V0IHR1cHBlbmNlXG4gICAgLy8gJ3R1cHBlbmNlJywgLy8gVGhlcmUncyBubyB0dXBwZW5jZSB3aXRob3V0IHRvb3RcbiAgICAncmlwcGVyJyxcbiAgICAncmFzcGJlcnJ5JyxcbiAgICAndHJ1bXBldCcsXG4gICAgJ3dpbmR5JyAvLyBBaGhoLCBDaGljYWdvXG5dO1xuXG5jb25zdCBjaG9zZW5TaGFrZXMgPSBbXG4gICAgJ3NoYWtlLWhhcmQnLFxuICAgICdzaGFrZS1jcmF6eSdcbl07XG5cbi8vIEluaXQgdGhlIGZhcnRzIGZyb20gZmFydC5qc1xuY29uc3QgeyBGYXJ0LCBmYXJ0cyB9ID0gcmVxdWlyZSgnLi9mYXJ0Jyk7XG5cbmNvbnN0IGZhcnQgPSBuZXcgRmFydCh7IHZvbHVtZTogMTAwIH0pO1xuXG53aW5kb3cuRmFydCA9IEZhcnQ7XG53aW5kb3cuYnJvbmt5RmFydCA9IGZhcnQ7XG53aW5kb3cuZmFydHMgPSBmYXJ0cztcblxuY29uc3QgcGxheUZhcnQgPSAoY2hvc2VuRmFydCkgPT4ge1xuXG4gICAgaWYgKCFQTEFZX0ZBUlRfU09VTkRTKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBmYXJ0LnBsYXkoY2hvc2VuRmFydCk7XG59O1xuXG5jb25zdCBicm9ua3kgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnJvbmt5Q29udGVudCcpO1xuXG4vLyBJbml0IEJyb25reSdzIHNoYWtlcyBmcm9tIENTU2hha2VzXG5jb25zdCBpbml0U2hha2VDbGFzc2VzID0gW1xuICAgICdzaGFrZS1jb25zdGFudCcsXG4gICAgJ3NoYWtlLXNsb3cnXG4gICAgLy8gJ3NoYWtlLWNvbnN0YW50LS1ob3ZlcidcbiAgICAvLyAnc2hha2UtZnJlZXplJ1xuICAgIC8vICdzaGFrZS1vcGFjaXR5J1xuXTtcblxuaWYgKFJVTl9TSEFLRVMpIHtcbiAgICBicm9ua3kuY2xhc3NMaXN0LmFkZCguLi5pbml0U2hha2VDbGFzc2VzKTtcbn1cblxubGV0IGlzRmFydGluZyA9IGZhbHNlO1xuXG5jb25zdCBzaGFrZUJyb25reSA9IChzaGFrZSwgZHVyYXRpb24pID0+IHtcblxuICAgIGlmICghUlVOX1NIQUtFUykge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaXNGYXJ0aW5nID0gdHJ1ZTtcblxuICAgIGJyb25reS5jbGFzc0xpc3QucmVtb3ZlKC4uLmNob3NlblNoYWtlcyk7XG5cbiAgICBicm9ua3kuY2xhc3NMaXN0LmFkZChzaGFrZSk7XG5cbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcblxuICAgICAgICBicm9ua3kuY2xhc3NMaXN0LnJlbW92ZShzaGFrZSk7XG4gICAgICAgIGlzRmFydGluZyA9IGZhbHNlO1xuICAgIH0sIGR1cmF0aW9uIHx8IE1hdGgucmFuZG9tKCkgKiAzMDAwICsgMjAwMCk7XG59O1xuXG5jb25zdCBtb2JpbGVSZWdleCA9IC9BbmRyb2lkfHdlYk9TfGlQaG9uZXxpUGFkfGlQb2R8QmxhY2tCZXJyeXxJRU1vYmlsZXxPcGVyYSBNaW5pL2k7XG5cbmxldCBpc01vYmlsZSA9IGZhbHNlO1xuXG5pZiAobW9iaWxlUmVnZXgudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSApIHtcbiAgICBpc01vYmlsZSA9IHRydWU7XG59XG5cbmxldCBsYXN0RmFydCA9IG51bGw7XG5sZXQgbGFzdFNoYWtlID0gbnVsbDtcblxuY29uc3QgYnJvbmt5RmFydCA9ICgpID0+IHtcblxuICAgIGNvbnN0IHNoYWtlRmFydFNldHRpbmdzID0ge1xuICAgICAgICB0b290OiB7XG4gICAgICAgICAgICBzaGFrZU5hbWVDaG9pY2VzOiBbJ3NoYWtlLWxpdHRsZScsICdzaGFrZS1yb3RhdGUnXSxcbiAgICAgICAgICAgIGR1cmF0aW9uOiAxMDAwXG4gICAgICAgIH0sXG4gICAgICAgIHR1cHBlbmNlOiB7XG4gICAgICAgICAgICBzaGFrZU5hbWVDaG9pY2VzOiBbJ3NoYWtlLWxpdHRsZScsICdzaGFrZS1yb3RhdGUnXSxcbiAgICAgICAgICAgIGR1cmF0aW9uOiAxMDAwXG4gICAgICAgIH0sXG4gICAgICAgIHJpcHBlcjoge1xuICAgICAgICAgICAgc2hha2VOYW1lQ2hvaWNlczogWydzaGFrZS1oYXJkJywgJ3NoYWtlLXZlcnRpY2FsJ10sXG4gICAgICAgICAgICBkdXJhdGlvbjogMTUwMFxuICAgICAgICB9LFxuICAgICAgICByYXNwYmVycnk6IHtcbiAgICAgICAgICAgIHNoYWtlTmFtZUNob2ljZXM6IFsnc2hha2UtY3JhenknLCAnc2hha2Utcm90YXRlJ10sXG4gICAgICAgICAgICBkdXJhdGlvbjogMjAwMFxuICAgICAgICB9LFxuICAgICAgICB0cnVtcGV0OiB7XG4gICAgICAgICAgICBzaGFrZU5hbWVDaG9pY2VzOiBbJ3NoYWtlLWhhcmQnLCAnc2hha2UtY3JhenknLCAnc2hha2Utcm90YXRlJ10sXG4gICAgICAgICAgICBkdXJhdGlvbjogMTQwMFxuICAgICAgICB9LFxuICAgICAgICB3aW5keToge1xuICAgICAgICAgICAgc2hha2VOYW1lQ2hvaWNlczogWydzaGFrZS1oYXJkJywgJ3NoYWtlLXJvdGF0ZSddLFxuICAgICAgICAgICAgZHVyYXRpb246IDU4MDBcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBjb25zdCByYW5kb21GYXJ0ID0gdXRpbHMucmFuZG9tRnJvbUFycmF5RXhjZXB0KGNob3NlbkZhcnRzLCBsYXN0RmFydCkgfHwgJ3Jhc3BiZXJyeSc7XG5cbiAgICBsYXN0RmFydCA9IHJhbmRvbUZhcnQ7XG5cbiAgICBjb25zdCB7IHNoYWtlTmFtZUNob2ljZXMsIGR1cmF0aW9uIH0gPSBzaGFrZUZhcnRTZXR0aW5nc1tyYW5kb21GYXJ0XTtcblxuICAgIHBsYXlGYXJ0KHJhbmRvbUZhcnQpO1xuXG4gICAgY29uc3QgQVVESU9fTE9BRF9USU1FT1VUID0gaXNNb2JpbGUgPyAyMDAgOiA0MDA7XG4gICAgc2V0VGltZW91dCgoKSA9PiB7XG5cbiAgICAgICAgY29uc3QgcmFuZG9tU2hha2UgPSB1dGlscy5yYW5kb21Gcm9tQXJyYXlFeGNlcHQoW10uY29uY2F0KHNoYWtlTmFtZUNob2ljZXMpLCBsYXN0U2hha2UpIHx8ICdzaGFrZS1yb3RhdGUnO1xuXG4gICAgICAgIGxhc3RTaGFrZSA9IHJhbmRvbVNoYWtlO1xuXG4gICAgICAgIHNoYWtlQnJvbmt5KFxuICAgICAgICAgICAgcmFuZG9tU2hha2UsXG4gICAgICAgICAgICBkdXJhdGlvblxuICAgICAgICApO1xuICAgIH0sIEFVRElPX0xPQURfVElNRU9VVCk7XG59O1xuXG5jb25zdCBva1N0b3BUaGVGYXJ0cyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdva1N0b3BUaGVGYXJ0c0J0bicpO1xuXG5pZiAoaXNNb2JpbGUpIHtcbiAgICBjb25zb2xlLmxvZygnaXNNb2JpbGUnLCBpc01vYmlsZSk7XG4gICAgb2tTdG9wVGhlRmFydHMuc3R5bGUucGFkZGluZyA9ICcyMDBweCc7XG59XG5cbi8vIFBvc2l0aW9uIHRoZSBpcCBhZGRyZXNzIGRpdlxuXG5jb25zdCBpc0xvY2FsID0gd2luZG93LmxvY2F0aW9uLmhvc3Quc3RhcnRzV2l0aCgnbG9jYWxob3N0OicpO1xuY29uc3QgaXNCcm9ua3kgPSB3aW5kb3cubG9jYXRpb24uaG9zdCA9PT0gJ2Jyb25reWNoYXJsZXMuY29tJztcbmNvbnN0IGlzQnJvbmtvbmlvdXMgPSB3aW5kb3cubG9jYXRpb24uaG9zdCA9PT0gJ2Jyb25rb25pb3VzY2hhcmxlc3Rvbi5jb20nO1xuXG5jb25zdCB1cklwID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3VyaXAnKTtcblxudXJJcC5zdHlsZS50b3AgPSAnMTc1cHgnO1xuXG5pZiAoaXNMb2NhbCB8fCBpc0Jyb25reSkge1xuICAgIHVySXAuc3R5bGUubGVmdCA9ICcxNTBweCc7XG4gICAgdXJJcC5zdHlsZS50cmFuc2Zvcm0gPSAncm90YXRlKC00NWRlZyknO1xufVxuZWxzZSBpZiAoaXNCcm9ua29uaW91cykge1xuICAgIHVySXAuc3R5bGUucmlnaHQgPSAnMTUwcHgnO1xuICAgIHVySXAuc3R5bGUudHJhbnNmb3JtID0gJ3JvdGF0ZSg0NWRlZyknO1xufVxuXG4vLyBJbml0IHRoZSB3ZWJwYWdlIHBsYXlpbmcgYSBmYXJ0IGluIGNhc2UgdGhhdCB3b3Jrcy5cbi8vIE5vcm1hbGx5IHRoZSB1c2VyIGhhcyB0byBpbnRlcmFjdCB3aXRoIHRoZSBkb2N1bWVudCBiZWZvcmVcbi8vIGEgc291bmQgY2FuIGJlIHBsYXllZC5cbi8vIEF0IGxlYXN0IHdlJ2xsIHNoYWtlIGJyb25reSBsb0xcbmJyb25reUZhcnQoKTtcblxuc2V0SW50ZXJ2YWwoKCkgPT4ge1xuXG4gICAgaWYgKCFpc0ZhcnRpbmcpIHtcbiAgICAgICAgYnJvbmt5RmFydCgpO1xuICAgIH1cbn0sIDEwMDAwKTtcblxuZG9jdW1lbnQub25jbGljayA9IGJyb25reUZhcnQ7XG5cbi8vIExpdmUgY2hhdFxuXG4vL1xuIl19
